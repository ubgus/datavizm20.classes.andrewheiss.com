---
title: "Themes"
linktitle: "5: Themes"
date: "2020-05-15"
class_date: "2020-05-15"
bibliography: ../../static/bib/references.bib
csl: ../../static/bib/chicago-syllabus-no-bib.csl
output:
  blogdown::html_page:
    toc: true
menu:
  lesson:
    parent: Lessons
    weight: 5
type: docs
weight: 5
editor_options: 
  chunk_output_type: console
shiny: true
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#complete-ggplot-themes">Complete ggplot themes</a></li>
<li><a href="#modifying-plot-elements-with-theme">Modifying plot elements with <code>theme()</code></a>
<ul>
<li><a href="#deal-with-general-plot-elements">Deal with general plot elements</a></li>
<li><a href="#disable-elements-completely-with-element_blank">Disable elements completely with <code>element_blank()</code></a></li>
<li><a href="#deal-with-borders-and-backgrounds-with-element_rect">Deal with borders and backgrounds with <code>element_rect()</code></a></li>
<li><a href="#deal-with-lines-with-element_line">Deal with lines with <code>element_line()</code></a></li>
<li><a href="#deal-with-text-with-element_text">Deal with text with <code>element_text()</code></a></li>
</ul></li>
<li><a href="#important-note-about-ordering">Important note about ordering</a></li>
<li><a href="#fonts">Fonts</a></li>
<li><a href="#reusing-themes">Reusing themes</a></li>
<li><a href="#saving-plots">Saving plots</a></li>
</ul>
</div>

<div id="complete-ggplot-themes" class="section level2">
<h2>Complete ggplot themes</h2>
<p>There are many built-in complete themes that have a good combination of all the different <code>theme()</code> options already set for you. By default, ggplot uses <code>theme_gray()</code> (also spelled <code>theme_grey()</code> for UK English; because the first developer of ggplot (Hadley Wickham) is from New Zealand, British spelling works throughout (e.g. you can use <code>colour</code> instead of <code>color</code>))</p>
<div class="puzzle">
<p><strong>Your turn</strong>: Add <code>theme_minimal()</code> to this plot:</p>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-1/" id="learnr-05-lesson-theme1" %}}
<p>Hopefully that was easy!</p>
<p>If you look at <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">the documentation for the different theme functions</a>, you’ll notice that there are a few optional arguments, like <code>base_size</code> and <code>base_family</code>. The <code>base_size</code> argument changes the base font size for the text in the plot, and it is 11 by default. Changing it to something like 20 will not make all the text in the plot be sized at 20—functions like <code>theme_minimal()</code> set the size of plot elements based on the <code>base_size</code>. For instance, in <code>theme_minimal()</code>, the plot title is set to be 120% of <code>base_size</code>, while the caption is 80%. Changing <code>base_size</code> will resize all the different elements accordingly.</p>
<div class="puzzle">
<p><strong>Your turn</strong>: Modify this plot to use <code>theme_minimal()</code> with a base size of 16:</p>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-2/" id="learnr-05-lesson-theme2" %}}
<p>Hopefully that was also fairly straightforward!</p>
</div>
<div id="modifying-plot-elements-with-theme" class="section level2">
<h2>Modifying plot elements with <code>theme()</code></h2>
<p>Using a complete theme like <code>theme_minimal()</code> or <code>theme_bw()</code> is a great starting point for getting a nice, clean, well designed plot. You’ll often need to make adjustments to smaller, more specific parts of the plot though. To do this, you can use the <code>theme()</code> function.</p>
<p><code>theme()</code> is a massive function and has perhaps the most possible arguments of any function in R. It is impossible to remember everything it can possibly do. Fortunately its documentation is incredible. Run <code>?theme</code> in your R console to see the help page, or <a href="https://ggplot2.tidyverse.org/reference/theme.html">go to this page online</a>.</p>
<div id="deal-with-general-plot-elements" class="section level3">
<h3>Deal with general plot elements</h3>
<p>A few arguments to <code>theme()</code> don’t use any special function—you can just specify settings with text like <code>"bottom"</code> or <code>"right"</code></p>
<div class="puzzle">
<p><strong>Your turn</strong>: Look at the <a href="https://ggplot2.tidyverse.org/reference/theme.html">documentation for <code>theme()</code> online</a>. Make this plot’s legend appear on the bottom instead of the left.</p>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-3/" id="learnr-05-lesson-theme3" %}}
</div>
<div id="disable-elements-completely-with-element_blank" class="section level3">
<h3>Disable elements completely with <code>element_blank()</code></h3>
<p>Any plot element can be disabled by using <code>element_blank()</code>. For instance, if you want to remove the axis ticks, you can use <code>theme(axis.ticks = element_blank())</code>.</p>
<div class="puzzle">
<p><strong>Your turn</strong>: Look at the <a href="https://ggplot2.tidyverse.org/reference/theme.html">documentation for <code>theme()</code> online</a>. Disable the panel grid in this plot.</p>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-4/" id="learnr-05-lesson-theme4" %}}
<p>You can also target more specific plot elements. You can specify something like <code>axis.text</code>, which applies to all axis text, or you can use <code>axis.text.y</code> to only target the text on the y-axis.</p>
<div class="puzzle">
<p><strong>Your turn</strong>: Look at the <a href="https://ggplot2.tidyverse.org/reference/theme.html">documentation for <code>theme()</code> online</a>. Make the following changes to this plot:</p>
<ul>
<li>Disable the major panel grid for the x-axis</li>
<li>Disable the minor panel grid for the x-axis</li>
<li>Disable the minor panel grid for the y-axis.</li>
</ul>
<p>You should only have three horizontal lines for the grid.</p>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-5/" id="learnr-05-lesson-theme5" %}}
<hr />
<p>Almost every other plot element fits into one of three categories: a rectangle, a line, or text. Changing the settings on these elements requires specific functions that correspond to these categories.</p>
</div>
<div id="deal-with-borders-and-backgrounds-with-element_rect" class="section level3">
<h3>Deal with borders and backgrounds with <code>element_rect()</code></h3>
<p>Things like the plot background or the panel background or the legend background are rectangles and can be manipulated with <code>element_rect()</code>. If you want the legend box to be yellow with a thin black border, you would use <code>theme(legend.box.background = element_rect(fill = "yellow", color = "black", size = 1)</code>.</p>
<div class="puzzle">
<p><strong>Your turn</strong>: Look at the <a href="https://ggplot2.tidyverse.org/reference/theme.html">documentation for <code>theme()</code></a> and the <a href="https://ggplot2.tidyverse.org/reference/element.html">documentation for <code>element()</code></a> online. Make the following changes to this plot:</p>
<ul>
<li>Fill the plot background with <span style="color: #F2D8CE">#F2D8CE</span></li>
<li>Fill the panel background with <span style="color: #608BA6">#608BA6</span>, and make the border <span style="color: #184759">#184759</span> with size = 5</li>
</ul>
<p>This will be a fairly ugly plot.</p>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-6/" id="learnr-05-lesson-theme6" %}}
</div>
<div id="deal-with-lines-with-element_line" class="section level3">
<h3>Deal with lines with <code>element_line()</code></h3>
<p>Things like the panel grid, tick marks, and axis lines are all lines and can be manipulated with <code>element_line()</code>. If you want the x-axis line to be a dotted orange like, you would use <code>theme(axis.line.x = element_line(color = "orange", linetype = "dotted")</code>.</p>
<div class="puzzle">
<p><strong>Your turn</strong>: Look at the <a href="https://ggplot2.tidyverse.org/reference/theme.html">documentation for <code>theme()</code></a> and the <a href="https://ggplot2.tidyverse.org/reference/element.html">documentation for <code>element()</code></a> online. Make the following changes to this plot:</p>
<ul>
<li>Make the major panel gridlines blue and dashed with size = 1</li>
</ul>
<p>This will also be a fairly ugly plot.</p>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-7/" id="learnr-05-lesson-theme7" %}}
</div>
<div id="deal-with-text-with-element_text" class="section level3">
<h3>Deal with text with <code>element_text()</code></h3>
<p>Finally, anything with text can be manipulated with <code>element_text()</code>, and you can specify all sorts of things, including font family (<code>family</code>), font weight (<code>face</code>), color (<code>color</code>), horizontal justification (<code>hjust</code>), angle (<code>angle</code>), and a bunch of other options. If you want the x-axis text to be italicized and rotated at a 45º angle, you would use <code>theme(axis.text.x = element_text(face = "italic", angle = 45))</code>.</p>
<div class="puzzle">
<p><strong>Your turn</strong>: Look at the <a href="https://ggplot2.tidyverse.org/reference/theme.html">documentation for <code>theme()</code></a> and the <a href="https://ggplot2.tidyverse.org/reference/element.html">documentation for <code>element()</code></a> online. Make the following changes to this plot:</p>
<ul>
<li>Make the y-axis text italic</li>
<li>Make the plot title right aligned, bold, and colored with <span style="color: #8C7811">#8C7811</span></li>
<li>Make the plot subtitle right aligned</li>
</ul>
</div>
{{% learnr url="https://andrewheiss.shinyapps.io/datavizm20_05-themes-8/" id="learnr-05-lesson-theme8" %}}
</div>
</div>
<div id="important-note-about-ordering" class="section level2">
<h2>Important note about ordering</h2>
<p>Things like <code>theme_grey()</code> or <code>theme_minimal()</code> are really just collections of changes to <code>theme()</code>, so the order is important when using a complete theme. If you do something like this to turn off the gridlines in the plot panel:</p>
<pre class="r"><code>ggplot(...) +
  geom_point(...) +
  theme(panel.grid = element_blank()) +
  theme_bw()</code></pre>
<p>…you’ll still have panel gridlines! That’s because <code>theme_bw()</code> turns them on, and you typed it after you turned it off. If you want to use both <code>theme_bw()</code> and remove the gridlines, you need to make sure any theme adjustments come after <code>theme_bw()</code>:</p>
<pre class="r"><code>ggplot(...) +
  geom_point(...) +
  theme_bw() +
  theme(panel.grid = element_blank())</code></pre>
</div>
<div id="fonts" class="section level2">
<h2>Fonts</h2>
<p>You can use <code>theme()</code> to change the fonts as well, though sometimes it’s a little tricky to get R to see the fonts on your computer—especially if you use Windows. <a href="https://www.andrewheiss.com/blog/2017/09/27/working-with-r-cairo-graphics-custom-fonts-and-ggplot/">This detailed blog post</a> explains how to work with custom fonts in ggplot and shows how to get it set up on Windows. It should Just Work™ on macOS.</p>
<p>In short, as long as you load the fonts correctly, you can specify different fonts either in a complete theme like <code>theme_minimal(base_family = "Comic Sans MS")</code> or in <code>theme()</code> like <code>theme(plot.title = element_text(family = "Papyrus"))</code>.</p>
</div>
<div id="reusing-themes" class="section level2">
<h2>Reusing themes</h2>
<p>If you want to repeat specific theme settings throughout a document, you can save yourself a ton of typing by storing the results of <code>theme()</code> to an object and reusing it. For instance, suppose you want your plots to be based on theme_minimal, have right aligned title and subtitle text, have the legend at the bottom, and have no minor gridlines. You can save all of that into an object named <code>my_neato_theme</code> or something, and then reuse it:</p>
<pre class="r"><code>my_neato_theme &lt;- theme_minimal() +
  theme(plot.title = element_text(hjust = 1),
        plot.subtitle = element_text(hjust = 1),
        legend.position = &quot;bottom&quot;,
        panel.grid.minor = element_blank())

# Make one plot
ggplot(data = mpg,
       mapping = aes(x = displ, y = hwy, color = drv)) +
  geom_point(size = 3) +
  labs(title = &quot;Engine displacement and highway MPG&quot;,
       subtitle = &quot;Heavier cars get worse mileage&quot;) +
  my_neato_theme</code></pre>
<p><img src="/lesson/05-lesson_files/figure-html/saved-theme-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Make another plot
ggplot(data = mpg,
       mapping = aes(x = displ, y = hwy, color = cty)) +
  geom_point(size = 3) +
  labs(title = &quot;Engine displacement and highway MPG&quot;,
       subtitle = &quot;Points colored by city MPG&quot;) +
  my_neato_theme</code></pre>
<p><img src="/lesson/05-lesson_files/figure-html/saved-theme-2.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="saving-plots" class="section level2">
<h2>Saving plots</h2>
<p>So far, all your plots have ended up either in RStudio or in a knitted HTML, Word, or PDF document. But what if you want to save just the plot to your computer so you can send it out to the world?! You could take a screenshot, but that won’t provide the highest resolution, and that will only save the plot as a bitmap-based PNG, not an infinitely resizable vector-based PDF!</p>
<p>Fortunately it’s pretty easy to save a plot using the special <code>ggsave()</code> function. You can specify whatever dimensions you want and whatever file type you want and save the standalone plot to your computer. You should look at the <a href="https://ggplot2.tidyverse.org/reference/ggsave.html">documentation for <code>ggsave()</code></a> for complete details of all the different options and arguments it can take. Typically, you do something like this.</p>
<p>First create a plot and store it as an object. We haven’t done that yet in this lesson—so far we’ve just run <code>ggplot()</code> and seen the output immediately. If you save the output of <code>ggplot()</code> to an object, you actually won’t see anything until you run the name of the object.</p>
<pre class="r"><code>a_cool_plot &lt;- ggplot(data = mpg,
                      mapping = aes(x = displ, y = hwy, color = drv)) +
  geom_point(size = 3) +
  labs(title = &quot;Engine displacement and highway MPG&quot;,
       subtitle = &quot;Heavier cars get worse mileage&quot;)

# Make sure you run this so you can see the plot
a_cool_plot</code></pre>
<p><img src="/lesson/05-lesson_files/figure-html/ggsave-example-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Next you can feed your saved plot to <code>ggsave()</code> to save it. It will automatically determine how to save it based on the filename you provide. If you tell it to be <code>something.png</code>, R will make a PNG; if you tell it to be <code>something.pdf</code>, R will make a PDF, and so on. Common types are PDF, PNG, JPEG (ew though), SVG, TIFF, and others.</p>
<p>You can also save the plot as multiple files. I typically make PNG and PDF versions of any plots I export like so:</p>
<pre class="r"><code>ggsave(filename = &quot;a_cool_plot.pdf&quot;, plot = a_cool_plot,
       width = 6, height = 4.5, units = &quot;in&quot;)

ggsave(filename = &quot;a_cool_plot.png&quot;, plot = a_cool_plot,
       width = 6, height = 4.5, units = &quot;in&quot;)</code></pre>
<p>From a file management perspective, it often makes sense to store all your output in a separate folder in your project, like <code>output</code> or <code>figures</code> or something. If you want to put saved images in a subfolder, include the name in the file name:</p>
<pre class="r"><code>ggsave(filename = &quot;figures/a_cool_plot.png&quot;, plot = a_cool_plot,
       width = 6, height = 4.5, units = &quot;in&quot;)</code></pre>
<p>And finally, if you’re using custom fonts, you need to add one bit of wizardry to get the fonts to embed correctly in PDFs. This is something you just have to memorize or copy and paste a lot—if you want to know the full details, <a href="https://www.andrewheiss.com/blog/2017/09/27/working-with-r-cairo-graphics-custom-fonts-and-ggplot/">see this blog post</a>. In short, R’s default PDF writer doesn’t know how to embed fonts and will panic if you make it try. R can use a different PDF-writing engine named Cairo that embeds fonts just fine, though, so you need to tell <code>ggsave()</code> to use it:</p>
<pre class="r"><code>ggsave(filename = &quot;figures/a_cool_plot.pdf&quot;, plot = a_cool_plot,
       width = 6, height = 4.5, units = &quot;in&quot;, device = cairo_pdf)</code></pre>
</div>
